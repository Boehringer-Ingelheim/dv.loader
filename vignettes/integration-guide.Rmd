---
title: "Integration Guide"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Integration Guide}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette showcases the integration of the {dv.loader} package with other packages from the DaVinci framework. It guides you through the process of combining {dv.loader} with {dv.manager} and {dv.listings} to create a modular Shiny application.

```{r, eval=FALSE}
# Install the {remotes} package if you haven't already
if (!require("remotes")) install.packages("remotes")

# Define the packages to install
pkgs <- c("dv.loader", "dv.manager", "dv.listings")

# Install the packages from GitHub
remotes::install_github(repo = paste0("Boehringer-Ingelheim/", pkgs))
```

For the purpose of this vignette, we will use the data from the {pharmaverseadam} package and save the `adsl` and `adae` datasets as .sas7bdat files in a temporary directory.

```{r, eval=FALSE}
# Create a temporary directory
temp_dir <- tempdir()

# Create a sub-directory for saving the pharmaverseadam data
data_dir <- file.path(temp_dir, "pharmaverseadam")
dir.create(data_dir)

# Save the adsl and adae datasets to the temporary directory
haven::write_sas(pharmaverseadam::adsl, file.path(data_dir, "adsl.sas7bdat"))
haven::write_sas(pharmaverseadam::adae, file.path(data_dir, "adae.sas7bdat"))
```

## Step 1: Load data files

```{r, eval=FALSE}
# Load data files from the specified file paths
data_list <- dv.loader::load_data_files(
  file_paths = file.path(data_dir, c("adsl.sas7bdat", "adae.sas7bdat"))
)
```

## Step 2: Create a module list

```{r, eval=FALSE}
# Include a module containing two data listings
module_list <- list(
  "Data Listings" = dv.listings::mod_listings(
    module_id = "data_listings",
    dataset_names = c("adsl.sas7bdat", "adae.sas7bdat")
  )
)
```

## Step 3: Run the DaVinci application

```{r, eval=FALSE}
# Run the DaVinci application with data and module lists defined earlier
dv.manager::run_app(
  data = list("Demo Data" = data_list),
  module_list = module_list,
  filter_data = "adsl.sas7bdat",
  title = "DaVinci Application"
)
```
